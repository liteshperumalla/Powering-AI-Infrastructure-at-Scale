# Production Kubernetes Secrets Configuration for Infra Mind
# This file contains comprehensive secret management templates

apiVersion: v1
kind: Secret
metadata:
  name: infra-mind-secrets
  namespace: infra-mind
  labels:
    app: infra-mind
    component: secrets
type: Opaque
data:
  # Base64 encoded secrets - replace with actual production values
  # Use: echo -n "your-secret-value" | base64
  
  # Application secrets
  secret-key: eW91ci1zZWN1cmUtand0LXNlY3JldC1rZXktYXQtbGVhc3QtMzItY2hhcmFjdGVycw==
  
  # Database secrets
  mongodb-url: bW9uZ29kYitzcnY6Ly91c2VybmFtZTpwYXNzd29yZEBjbHVzdGVyLm1vbmdvZGIubmV0L2luZnJhX21pbmQ=
  redis-url: cmVkaXNzOi8vdXNlcm5hbWU6cGFzc3dvcmRAcmVkaXMtY2x1c3Rlci5jYWNoZS5hbWF6b25hd3MuY29tOjYzODA=
  
  # LLM API keys
  openai-api-key: c2steW91ci1vcGVuYWktYXBpLWtleS1oZXJl
  anthropic-api-key: c2stYW50LXlvdXItYW50aHJvcGljLWFwaS1rZXktaGVyZQ==
  azure-openai-api-key: eW91ci1henVyZS1vcGVuYWktYXBpLWtleQ==
  azure-openai-endpoint: aHR0cHM6Ly95b3VyLXJlc291cmNlLm9wZW5haS5henVyZS5jb20v
  
  # AWS credentials
  aws-access-key-id: QUtJQVlPVVJBV1NBQ0NFU1NLRVlJRA==
  aws-secret-access-key: eW91ci1hd3Mtc2VjcmV0LWFjY2Vzcy1rZXk=
  aws-session-token: eW91ci1hd3Mtc2Vzc2lvbi10b2tlbi1pZi11c2luZy10ZW1wb3JhcnktY3JlZGVudGlhbHM=
  
  # Azure credentials
  azure-client-id: eW91ci1henVyZS1jbGllbnQtaWQ=
  azure-client-secret: eW91ci1henVyZS1jbGllbnQtc2VjcmV0
  azure-tenant-id: eW91ci1henVyZS10ZW5hbnQtaWQ=
  azure-subscription-id: eW91ci1henVyZS1zdWJzY3JpcHRpb24taWQ=
  
  # GCP credentials
  gcp-project-id: eW91ci1nY3AtcHJvamVjdC1pZA==
  gcp-service-account-json: eXlvdXItZ2NwLXNlcnZpY2UtYWNjb3VudC1qc29uLWNvbnRlbnQ=
  
  # Terraform Cloud
  tf-cloud-token: eW91ci10ZXJyYWZvcm0tY2xvdWQtdG9rZW4=
  tf-cloud-organization: eW91ci10ZXJyYWZvcm0tb3JnYW5pemF0aW9u
  
  # External services
  google-search-api-key: eW91ci1nb29nbGUtc2VhcmNoLWFwaS1rZXk=
  google-search-engine-id: eW91ci1jdXN0b20tc2VhcmNoLWVuZ2luZS1pZA==
  bing-search-api-key: eW91ci1iaW5nLXNlYXJjaC1hcGkta2V5
  
  # Monitoring
  sentry-dsn: aHR0cHM6Ly95b3VyLXNlbnRyeS1kc25Ac2VudHJ5LmlvL3Byb2plY3QtaWQ=
  
  # Webhooks
  webhook-secret: eW91ci13ZWJob29rLXNlY3JldC1mb3ItdmVyaWZpY2F0aW9u

---
apiVersion: v1
kind: Secret
metadata:
  name: infra-mind-tls
  namespace: infra-mind
  labels:
    app: infra-mind
    component: tls
type: kubernetes.io/tls
data:
  # TLS certificate and key for HTTPS
  # Replace with your actual certificate and key
  tls.crt: LS0tLS1CRUdJTiBDRVJUSUZJQ0FURS0tLS0t...
  tls.key: LS0tLS1CRUdJTiBQUklWQVRFIEtFWS0tLS0t...

---
apiVersion: v1
kind: ConfigMap
metadata:
  name: infra-mind-config
  namespace: infra-mind
  labels:
    app: infra-mind
    component: config
data:
  # Non-secret configuration
  INFRA_MIND_ENVIRONMENT: "production"
  INFRA_MIND_DEBUG: "false"
  INFRA_MIND_API_HOST: "0.0.0.0"
  INFRA_MIND_API_PORT: "8000"
  INFRA_MIND_API_PREFIX: "/api/v1"
  
  # Database configuration
  INFRA_MIND_MONGODB_DATABASE: "infra_mind"
  INFRA_MIND_MONGODB_MAX_CONNECTIONS: "100"
  INFRA_MIND_MONGODB_MIN_CONNECTIONS: "10"
  INFRA_MIND_REDIS_MAX_CONNECTIONS: "20"
  
  # LLM configuration
  INFRA_MIND_LLM_MODEL: "gpt-4"
  INFRA_MIND_LLM_TEMPERATURE: "0.1"
  INFRA_MIND_LLM_MAX_TOKENS: "4000"
  INFRA_MIND_LLM_TIMEOUT: "60"
  
  # Cloud provider regions
  INFRA_MIND_AWS_REGION: "us-east-1"
  INFRA_MIND_GCP_REGION: "us-central1"
  
  # Rate limiting
  INFRA_MIND_RATE_LIMIT_REQUESTS: "1000"
  INFRA_MIND_RATE_LIMIT_BURST: "2000"
  INFRA_MIND_AWS_RATE_LIMIT: "500"
  INFRA_MIND_AZURE_RATE_LIMIT: "2000"
  INFRA_MIND_GCP_RATE_LIMIT: "500"
  
  # Caching
  INFRA_MIND_CACHE_ENABLED: "true"
  INFRA_MIND_CACHE_DEFAULT_TTL: "3600"
  INFRA_MIND_CACHE_PRICING_TTL: "86400"
  
  # Security
  INFRA_MIND_ACCESS_TOKEN_EXPIRE_MINUTES: "30"
  INFRA_MIND_REFRESH_TOKEN_EXPIRE_DAYS: "7"
  INFRA_MIND_ALGORITHM: "HS256"
  INFRA_MIND_SECURITY_HEADERS_ENABLED: "true"
  INFRA_MIND_HSTS_MAX_AGE: "31536000"
  
  # CORS (production domains)
  INFRA_MIND_CORS_ORIGINS: '["https://yourdomain.com","https://www.yourdomain.com","https://app.yourdomain.com"]'
  INFRA_MIND_CORS_ALLOW_CREDENTIALS: "true"
  
  # Logging
  INFRA_MIND_LOG_LEVEL: "INFO"
  INFRA_MIND_LOG_FORMAT: "json"
  INFRA_MIND_LOG_FILE: "/var/log/infra-mind/app.log"
  
  # Monitoring
  INFRA_MIND_METRICS_ENABLED: "true"
  INFRA_MIND_HEALTH_CHECK_INTERVAL: "30"
  
  # File uploads
  INFRA_MIND_MAX_FILE_SIZE: "10485760"
  INFRA_MIND_ALLOWED_FILE_TYPES: '[".json",".yaml",".yml",".txt",".csv"]'

---
# External Secrets Operator configuration (recommended for production)
apiVersion: external-secrets.io/v1beta1
kind: SecretStore
metadata:
  name: vault-backend
  namespace: infra-mind
spec:
  provider:
    vault:
      server: "https://vault.example.com"
      path: "secret"
      version: "v2"
      auth:
        kubernetes:
          mountPath: "kubernetes"
          role: "infra-mind"

---
apiVersion: external-secrets.io/v1beta1
kind: ExternalSecret
metadata:
  name: infra-mind-external-secrets
  namespace: infra-mind
spec:
  refreshInterval: 15s
  secretStoreRef:
    name: vault-backend
    kind: SecretStore
  target:
    name: infra-mind-vault-secrets
    creationPolicy: Owner
  data:
  # Database secrets
  - secretKey: mongodb-url
    remoteRef:
      key: infra-mind/database
      property: mongodb_url
  - secretKey: redis-url
    remoteRef:
      key: infra-mind/database
      property: redis_url
  
  # Application secrets
  - secretKey: secret-key
    remoteRef:
      key: infra-mind/app
      property: secret_key
  
  # LLM secrets
  - secretKey: openai-api-key
    remoteRef:
      key: infra-mind/llm
      property: openai_key
  - secretKey: anthropic-api-key
    remoteRef:
      key: infra-mind/llm
      property: anthropic_key
  
  # AWS secrets
  - secretKey: aws-access-key-id
    remoteRef:
      key: infra-mind/aws
      property: access_key_id
  - secretKey: aws-secret-access-key
    remoteRef:
      key: infra-mind/aws
      property: secret_access_key
  
  # Azure secrets
  - secretKey: azure-client-id
    remoteRef:
      key: infra-mind/azure
      property: client_id
  - secretKey: azure-client-secret
    remoteRef:
      key: infra-mind/azure
      property: client_secret
  - secretKey: azure-tenant-id
    remoteRef:
      key: infra-mind/azure
      property: tenant_id
  
  # GCP secrets
  - secretKey: gcp-project-id
    remoteRef:
      key: infra-mind/gcp
      property: project_id
  - secretKey: gcp-service-account-json
    remoteRef:
      key: infra-mind/gcp
      property: service_account_json

---
# AWS Secrets Manager integration (alternative)
apiVersion: external-secrets.io/v1beta1
kind: SecretStore
metadata:
  name: aws-secrets-manager
  namespace: infra-mind
spec:
  provider:
    aws:
      service: SecretsManager
      region: us-east-1
      auth:
        secretRef:
          accessKeyID:
            name: aws-credentials
            key: access-key-id
          secretAccessKey:
            name: aws-credentials
            key: secret-access-key

---
# Azure Key Vault integration (alternative)
apiVersion: external-secrets.io/v1beta1
kind: SecretStore
metadata:
  name: azure-key-vault
  namespace: infra-mind
spec:
  provider:
    azurekv:
      vaultUrl: "https://your-keyvault.vault.azure.net/"
      authType: ServicePrincipal
      clientId: "your-client-id"
      clientSecret:
        secretRef:
          name: azure-credentials
          key: client-secret
      tenantId: "your-tenant-id"

---
# GCP Secret Manager integration (alternative)
apiVersion: external-secrets.io/v1beta1
kind: SecretStore
metadata:
  name: gcp-secret-manager
  namespace: infra-mind
spec:
  provider:
    gcpsm:
      projectId: "your-gcp-project-id"
      auth:
        secretRef:
          secretAccessKey:
            name: gcp-credentials
            key: service-account-key